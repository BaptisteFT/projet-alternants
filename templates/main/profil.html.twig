{% extends "base.html.twig" %}
{% block head %}
    {{ parent() }}
{% endblock %}
{% block header %}
    {{ parent() }}
{% endblock %}
{% block content %}
<main>
    <h2>Informations de l'utilisateur</h2>

    <ul>
        <li>Nom :  {{ user.lastName }}</li>
        <li>Prénom :  {{ user.firstName }}</li>
        <li>Email :  {{ user.email }}</li>
    </ul>

    {% if is_granted('ROLE_STUDENT') %}
        {% if token is not null %}
            <h2>lien de connexion actif :</h2>
            <p>Url : {{ token.generateUrl }}</p> <br>
            <p>Date d'expiration :  {{ token.expireDate|date("m/d/Y") }}</p> <br>
            <p>vous pouvez regénérer un lien en appuyant sur le button ci-dessous</p>
            <a href="{{ path('create_token', {userId: user.id}) }}"> Générer un lien de connexion</a>
            {{ dump(token) }}
        {% else %}
            <p>Aucun lien n'est actuellement générer, vous pouvez en générer en appuyant sur le button ci-dessous</p>
            <a href="{{ path('create_token', {userId: user.id}) }}"> Générer un lien de connexion</a>
        {% endif %}
    {% endif %}

    {% if user.status == "WORKING"%}
        {% if infos is not empty %}
            <h2>Fiche de Poste</h2>
            <table>
                <tr>
                    <th>Eleve</th>
                    <th>Intitulé du poste</th>
                    <th>Description</th>
                    <th>Actions</th>
                </tr>
                {% for info in infos %}
                    <tr>
                        <td>{{ info.student.firstName }} {{ info.student.lastName }}</td>
                        <td>
                            {{ info.title }}
                        </td>
                        <td>{{ info.description }}</td>
                        <td>
                            <a href="{{ path('delete_jobinfo', {'jobinfoId': info.getId()}) }}"> Supprimer</a>
                            <a href="{{ path('update_jobinfo', {'jobinfoId': info.getId()}) }}"> Modifier</a>
                        </td>
                    </tr>
                {% endfor %}
            </table>
            {% else %}
            <p>vous pouvez renseigner votre fiche de poste en <a href="{{ path('create_jobinfo', {'studentId': user.id}) }}" >cliquant ici</a> </p>

            {% endif %}
    {% endif %}
</main>
{% endblock %}
{% block footer %}
    {{ parent() }}
{% endblock %}